!function(a){"use strict";a.module("camera",[])}(angular),function(a){"use strict";function b(){var a=this;a.picture=!1}a.module("camera").controller("cameraController",b),b.$inject=[]}(angular),function(a){"use strict";function b(a,b){function c(c,d,e){c.libraryLoaded=!1,c.cameraLive=!1,c.activeCountdown=!1,void 0===c.viewerHeight&&(c.viewerHeight="auto"),void 0===c.viewerWidth&&(c.viewerWidth="auto"),void 0===c.outputHeight&&(c.outputHeight=c.viewerHeight),void 0===c.outputWidth&&(c.outputWidth=c.viewerWidth),void 0!==c.cropHeight&&void 0!==c.cropWidth||(c.cropHeight=!1,c.cropWith=!1),Webcam.set({width:c.viewerWidth,height:c.viewerHeight,dest_width:c.outputWidth,dest_height:c.outputHeight,crop_width:c.cropWidth,crop_height:c.cropHeight,image_format:c.imageFormat,jpeg_quality:c.jpegQuality,force_flash:!1}),"undefined"!==c.flashFallbackUrl&&Webcam.setSWFLocation(c.flashFallbackUrl),Webcam.attach("#ng-camera-feed-"+c.id),Webcam.on("load",function(){console.info("library loaded"),c.$apply(function(){c.libraryLoaded=!0})}),Webcam.on("live",function(){console.info("camera live"),c.$apply(function(){c.cameraLive=!0})}),Webcam.on("error",function(a){console.error("WebcameJS directive ERROR: ",a)}),void 0!==c.shutterUrl&&(c.shutter=new Audio,c.shutter.autoplay=!1,navigator.userAgent.match(/Firefox/)?c.shutter.src=c.shutterUrl.split(".")[0]+".ogg":c.shutter.src=c.shutterUrl),void 0!==c.countdown&&(c.countdownTime=1e3*parseInt(c.countdown),c.countdownText=parseInt(c.countdown)),c.countdownStart=function(){c.activeCountdown=!0,c.countdownPromise=a.defer(),c.countdownTick=setInterval(function(){return c.$apply(function(){var a;a=parseInt(c.countdownText)-1,0===a?(c.countdownText=null!=c.captureMessage?c.captureMessage:"GO!",clearInterval(c.countdownTick),c.countdownPromise.resolve()):c.countdownText=a})},1e3)},c.getSnapshot=function(a){a.preventDefault(),void 0!==c.countdown?(c.countdownStart(),c.countdownPromise.promise.then(function(){b(function(){c.activeCountdown=!1,c.countdownText=parseInt(c.countdown)},2e3),void 0!==c.shutterUrl&&c.shutter.play(),Webcam.snap(function(a){c.snapshot=a})})):(void 0!==c.shutterUrl&&c.shutter.play(),Webcam.snap(function(a){c.snapshot=a}))},c.$on("$destroy",function(){Webcam.reset()})}return{restrict:"E",scope:{id:"@",actionMessage:"@",captureMessage:"@",countdown:"@",flashFallbackUrl:"@",overlayUrl:"@",outputHeight:"@",outputWidth:"@",shutterUrl:"@",viewerHeight:"@",viewerWidth:"@",cropHeight:"@",cropWidth:"@",imageFormat:"@",jpegQuality:"@",snapshot:"="},template:['<div class="ng-camera">','<div class="ng-camera-countdown" ng-if="countdown" ng-show="activeCountdown">','<p class="tick">{{countdownText}}</p>',"</div>",'<div class="ng-camera-stack">','<img class="ng-camera-overlay" ng-if="overlayUrl" ng-show="cameraLive" ng-src="{{overlayUrl}}" alt="overlay">','<div id="ng-camera-feed-{{::id}}"></div>',"</div>",'<button id="ng-camera-action" ng-click="getSnapshot($event)">{{actionMessage}}</button>',"</div>"].join(""),link:c}}a.module("camera").directive("ngCamera",b),b.$inject=["$q","$timeout"]}(angular);
